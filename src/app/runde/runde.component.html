<p-toast position="top-center"></p-toast>

<p-confirmDialog icon="pi pi-exclamation-triangle" ></p-confirmDialog>

<p-dialog header="{{getAnzahlGewinner()}} Gewinner auswÃ¤hlen!" [(visible)]="displayGewinnerDialog" 
  [modal]="true" [responsive]="true">
       
  <div>Ergebnis: {{aktuelleRunde.ergebnis}} {{aktuelleRunde.ergebnis !== 1 ? "Punkte" : "Punkt"}}</div>
  <p-listbox [options]="aktuelleRunde.spieler" [(ngModel)]="selectedGewinner" 
    multiple="multiple" checkbox="checkbox" optionLabel="name" [showToggleAll]="false">
  </p-listbox>
  <p-footer>
      <p-button label="Ok" icon="pi pi-check" (onClick)="rundeAbgerechnet()" [disabled]="selectedGewinner.length !== getAnzahlGewinner()" ></p-button>
      <p-button label="Cancel" icon="pi pi-close" (onClick)="displayGewinnerDialog=false"  class="ui-button-secondary"></p-button>
  </p-footer>

</p-dialog>

<p-toolbar>
  <div class="ui-toolbar-group-left">
   <p-button icon="pi pi-bars" routerLink="/rundenliste"></p-button>
   <span class="box"> </span><span class="box"> </span>
   <p-button icon="pi pi-angle-left" (click)="vorherigeRunde()"></p-button>
   <span class="box"> </span>
   <p-button icon="pi pi-angle-right" (click)="naechsteRunde()"></p-button>
  </div>
  <!-- <div class="ui-toolbar-group-right">
    <p-button *ngIf="!isNochNichtGespielteRunde()" [disabled]="aktuelleRunde.gespielt === undefined" 
      (onClick)="rundeAbrechnen()" icon="pi pi-check" styleClass="ui-button-success">
    </p-button>
  </div> -->
</p-toolbar>

 <div>

  <p-fieldset legend="Runde Nr. {{aktuelleRunde.nr}} von {{spieltag.anzahlRunden}} ({{getStatusDerRunde()}})">
    <span *ngFor="let info of getRundenInfo()"  class="box">{{info}}</span> 
    <div *ngIf="!isNochNichtGespielteRunde()" class="box">{{getPunktestand()}}</div> 
  </p-fieldset>

  <p-fieldset legend="Angesagt" *ngIf="!isNochNichtGespielteRunde()" >
    <div class="p-grid p-dir-col">
      <div class="p-col">
        <p-checkbox class="p-col" [(ngModel)]="aktuelleRunde.reVonVorneHerein" 
          label="von vorneherein" binary="true" (onChange)="vonVorneHereinChanged(true)">
        </p-checkbox>
        <p-dropdown class="p-col"  [options]="moeglicheReAnsagen" [(ngModel)]="aktuelleRunde.reAngesagt"></p-dropdown>
      </div>
      <div class="p-col">
        <p-checkbox  class="p-col" [(ngModel)]="aktuelleRunde.kontraVonVorneHerein" 
          label="von vorneherein" binary="true" (onChange)="vonVorneHereinChanged(false)">
        </p-checkbox>
        <p-dropdown  class="p-col" [options]="moeglicheKontraAnsagen" [(ngModel)]="aktuelleRunde.kontraAngesagt"></p-dropdown>
      </div>
    </div>
  </p-fieldset>

  <p-fieldset legend="Gespielt" *ngIf="!isNochNichtGespielteRunde()">
      <div class="p-grid p-dir-col">
        <div class="p-col">
          <p-dropdown class="p-col" [options]="moeglicheSoli" [(ngModel)]="aktuelleRunde.solo" optionLabel="name"></p-dropdown>
          <p-checkbox class="p-col" [(ngModel)]="aktuelleRunde.armut" label="Armut" binary="true"></p-checkbox>  
          <p-checkbox class="p-col" [(ngModel)]="aktuelleRunde.gegenDieSau" label="gegen die Sau" binary="true"></p-checkbox>
        </div>
        <div class="p-col"> 
          <p-dropdown class="p-col" [options]="moeglicheErgebnisse" [(ngModel)]="aktuelleRunde.gespielt"></p-dropdown>
          <span class="p-col">Extrapunkte: </span> <p-spinner [readonly]="true" size="1" [(ngModel)]="aktuelleRunde.extrapunkte"></p-spinner>
        </div>
        <div class="p-col"> 
          <p-button class="p-col" [disabled]="aktuelleRunde.gespielt === undefined" 
            label="{{aktuelleRunde.isAktuelleRunde() ? 'Runde abrechnen' : 'Runde korrigieren'}}" 
            styleClass="{{aktuelleRunde.isAktuelleRunde() ? 'ui-button-success' : 'ui-button-danger'}}"
            (onClick)="rundeAbrechnen()" icon="pi pi-check" >
          </p-button>
        </div>
    </div>
  </p-fieldset>

 

</div>
